!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var n=t();for(var r in n)("object"==typeof exports?exports:e)[r]=n[r]}}(self,(()=>(()=>{"use strict";var e={805:e=>{e.exports=o,e.exports.isMobile=o,e.exports.default=o;const t=/(android|bb\d+|meego).+mobile|armv7l|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series[46]0|samsungbrowser.*mobile|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i,n=/CrOS/,r=/android|ipad|playbook|silk/i;function o(e){e||(e={});let o=e.ua;if(o||"undefined"==typeof navigator||(o=navigator.userAgent),o&&o.headers&&"string"==typeof o.headers["user-agent"]&&(o=o.headers["user-agent"]),"string"!=typeof o)return!1;let i=t.test(o)&&!n.test(o)||!!e.tablet&&r.test(o);return!i&&e.tablet&&e.featureDetect&&navigator&&navigator.maxTouchPoints>1&&-1!==o.indexOf("Macintosh")&&-1!==o.indexOf("Safari")&&(i=!0),i}}},t={};function n(r){var o=t[r];if(void 0!==o)return o.exports;var i=t[r]={exports:{}};return e[r](i,i.exports,n),i.exports}n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var r={};return(()=>{n.r(r),n.d(r,{connectCloudinaryAnalytics:()=>W});var e=n(805),t="play",o="pause",i="loadMetadata",a="viewStart",u="viewEnd";function l(e){return l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l(e)}var c=function(e){var t="function"==typeof e?e():e;if("object"===l(t)&&null!==t&&!Array.isArray(t)){var n=function(e){return Array.from({length:5}).reduce((function(t,n,r){var o="customData".concat(r+1);return"string"==typeof e[o]&&(t[o]=e[o]),t}),{})}(t);return Object.keys(n).length>0?n:null}return null},d=function(e){return null!==e&&"object"===l(e)&&"string"==typeof e.cloudName&&e.cloudName&&"string"==typeof e.publicId&&e.publicId?{cloudName:e.cloudName,publicId:e.publicId}:null},s=/^(0|[1-9]\d*)\.(0|[1-9]\d*)\.(0|[1-9]\d*)(?:-((?:0|[1-9]\d*|\d*[a-zA-Z-][0-9a-zA-Z-]*)(?:\.(?:0|[1-9]\d*|\d*[a-zA-Z-][0-9a-zA-Z-]*))*))?(?:\+([0-9a-zA-Z-]+(?:\.[0-9a-zA-Z-]+)*))?$/,f="native",y=[f,"cloudinary video player"],p=function(e){return y.includes(e)?e:f},v=function(e){return"string"==typeof e&&s.test(e)?e:null};function m(e){return m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},m(e)}function g(e){return function(e){if(Array.isArray(e))return b(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return b(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?b(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function b(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function h(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function w(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?h(Object(n),!0).forEach((function(t){S(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):h(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function S(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=m(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=m(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==m(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var E=function(e,t){var n=c(null==t?void 0:t.customData),r=function(e){return null!==e&&JSON.stringify(e).length<=1e3}(n),o=null!=t&&t.customVideoUrlFallback?function(e,t){try{var n=t(e);return{cloudName:n.cloudName,publicId:n.publicId}}catch(e){return null}}(e.videoUrl,t.customVideoUrlFallback):null,i=d(o);return P(a,w(w({},e),{},{analyticsModuleVersion:"1.8.2",videoPlayer:{type:p(null==t?void 0:t.videoPlayerType),version:v(null==t?void 0:t.videoPlayerVersion)},customerData:w(w({},r?{providedData:n}:{}),i?{videoData:i}:{})}))},V=function(){return P(u,w({},arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}))},P=function(e,t){return{eventName:e,eventTime:Date.now(),eventDetails:t}},I=function(e){var t=g(e);return JSON.stringify(t)};function j(e){return function(e){if(Array.isArray(e))return A(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return A(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?A(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function A(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var O=function(e){var n={},r={};return function(){var a=null,u=[],l=function(e,t){if(!a)throw new Error("Events collector session not started");r[a].push(P(e,t))};return{flushEvents:function(){var e;if(!a)throw new Error("Events collector session not started");var t=r[a].splice(0,r[a].length);return(e=n[a]).splice.apply(e,[n[a].length,0].concat(j(t))),t},getCollectedEventsCount:function(){var e;return a&&(null===(e=r[a])||void 0===e?void 0:e.length)||0},addEvent:function(e){var t=e.eventName,n=e.eventDetails;return l(t,n)},start:function(c){if(a)throw new Error("Events collector session already started");n[a=c]=[],r[a]=[],u.push(function(e,n){var r=e.onPlay((function(){n(t,{})}));return function(){r()}}(e,l),function(e,t){var n=e.onPause((function(){t(o,{})})),r=e.onEmptied((function(){t(o,{})}));return function(){n(),r()}}(e,l),function(e,t){var n=function(){var n,r;t(i,{videoDuration:(n=e.getDuration(),r=Number.isNaN(n)?null:n,Number.POSITIVE_INFINITY===r?"Infinity":r),videoUrl:e.getCurrentSrc()})},r=e.onLoadedMetadata((function(){return n()}));return e.getReadyState()>0&&setTimeout((function(){return n()}),0),function(){r()}}(e,l))},destroy:function(){if(!a)throw new Error("Events collector session not started");u.forEach((function(e){return e()})),a=null}}}};const k={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};let C;const D=new Uint8Array(16);function M(){if(!C&&(C="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!C))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return C(D)}const T=[];for(let e=0;e<256;++e)T.push((e+256).toString(16).slice(1));function U(e,t=0){return(T[e[t+0]]+T[e[t+1]]+T[e[t+2]]+T[e[t+3]]+"-"+T[e[t+4]]+T[e[t+5]]+"-"+T[e[t+6]]+T[e[t+7]]+"-"+T[e[t+8]]+T[e[t+9]]+"-"+T[e[t+10]]+T[e[t+11]]+T[e[t+12]]+T[e[t+13]]+T[e[t+14]]+T[e[t+15]]).toLowerCase()}const N=function(e,t,n){if(k.randomUUID&&!t&&!e)return k.randomUUID();const r=(e=e||{}).random||(e.rng||M)();if(r[6]=15&r[6]|64,r[8]=63&r[8]|128,t){n=n||0;for(let e=0;e<16;++e)t[n+e]=r[e];return t}return U(r)};var x="cld-analytics-user-id",L=function(){return N().replace(/-/g,"")},_=function(e,t){var n=Object.keys(t).reduce((function(e,n){return e.append(n,t[n]),e}),new FormData);return"function"!=typeof window.navigator.sendBeacon?window.fetch(e,{method:"POST",mode:"no-cors",body:n,keepalive:!0}):window.navigator.sendBeacon(e,n)};function z(e){return z="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},z(e)}var F=function(e,t){if(!e.isValid)throw t?"".concat(t,":")+"\n\n"+e.errorMessage:e.errorMessage},R=function(e){return e&&"object"!==z(e)?{isValid:!1,errorMessage:"Options property must be an object"}:{isValid:!0}},Z=function(e,t,n){return e.addEventListener(t,n),function(){e.removeEventListener(t,n)}},Y=function(e,t){return t?$(e):B(e)},$=function(e){var t=e.onPageViewStart,n=e.onPageViewEnd,r=function(){"visible"===document.visibilityState?null==t||t():"hidden"===document.visibilityState&&(null==n||n())};return document.addEventListener("visibilitychange",r),"visible"===document.visibilityState&&(null==t||t()),function(){document.removeEventListener("visibilitychange",r)}},B=function(e){var t=e.onPageViewStart,n=e.onPageViewEnd,r=function(){return null==t?void 0:t()},o=function(){return null==n?void 0:n()};return"complete"===document.readyState?r():window.addEventListener("load",r),window.addEventListener("beforeunload",o),function(){window.removeEventListener("load",r),window.removeEventListener("beforeunload",o)}};function H(e){return function(e){if(Array.isArray(e))return J(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return J(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?J(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function J(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var q={default:"https://video-analytics-api.cloudinary.com/v1/video-analytics",liveStreams:"https://video-analytics-api.cloudinary.com/v1/live-streams"},W=function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};F(function(e){return e&&"object"!==z(e)?{isValid:!1,errorMessage:"Options property must be an object"}:{isValid:!0}}(n),"Cloudinary video analytics requires proper options object"),n.playerAdapter||(n.playerAdapter=function(e){return{onCanPlay:function(t){return Z(e,"canplay",t)},onCanPlayThrough:function(t){return Z(e,"canplaythrough",t)},onComplete:function(t){return Z(e,"complete",t)},onDurationChange:function(t){return Z(e,"durationchange",t)},onEmptied:function(t){return Z(e,"emptied",t)},onEnded:function(t){return Z(e,"ended",t)},onError:function(t){return Z(e,"error",t)},onLoadedData:function(t){return Z(e,"loadeddata",t)},onLoadedMetadata:function(t){return Z(e,"loadedmetadata",t)},onLoadStart:function(t){return Z(e,"loadstart",t)},onPause:function(t){return Z(e,"pause",t)},onPlay:function(t){return Z(e,"play",t)},onPlaying:function(t){return Z(e,"playing",t)},onProgress:function(t){return Z(e,"progress",t)},onRateChange:function(t){return Z(e,"ratechange",t)},onSeeked:function(t){return Z(e,"seeked",t)},onSeeking:function(t){return Z(e,"seeking",t)},onStalled:function(t){return Z(e,"stalled",t)},onSuspend:function(t){return Z(e,"suspend",t)},onTimeUpdate:function(t){return Z(e,"timeupdate",t)},onVolumeChange:function(t){return Z(e,"volumechange",t)},onWaiting:function(t){return Z(e,"waiting",t)},getCurrentSrc:function(){return e.currentSrc},getCurrentTime:function(){return e.currentTime},getReadyState:function(){return e.readyState},getDuration:function(){return e.duration}}}(t));var r=null,o=function(){var e=window.localStorage.getItem(x);if(e)return e;var t=N().replace(/-/g,"");return window.localStorage.setItem(x,t),t}(),i=n.playerAdapter,l=(0,e.isMobile)({tablet:!0,featureDetect:!0}),c=O(i),s=function(){r&&(r.clear(),r=null)},f={_value:L(),getValue:function(){return f._value},regenerateValue:function(){return f._value=L(),r&&(r.viewId=f._value),f._value}},y=function(e,t){var n=c(),a=function(){if(n.getCollectedEventsCount()>0){n.addEvent(V());var e=I(H(n.flushEvents()));t={userId:o,viewId:f.getValue(),events:e},_(q.default,t)}var t},u=Y({onPageViewStart:function(){f.regenerateValue(),n.start(f.getValue()),n.addEvent(E({videoUrl:i.getCurrentSrc(),trackingType:"manual"},t))},onPageViewEnd:function(){a(),n.destroy()}},l);r={viewId:f,type:"manual",subtype:"default",clear:function(){a(),n.destroy(),u()}}},m=function(e,t){var n=d(e),i=function(e){_(q.liveStreams,{userId:o,viewId:f.getValue(),events:I([e])})},c=Y({onPageViewStart:function(){var e;f.regenerateValue(),i((e=t,P(a,w(w({},{liveStreamData:n}),{},{analyticsModuleVersion:"1.8.2",videoPlayer:{type:p(null==e?void 0:e.videoPlayerType),version:v(null==e?void 0:e.videoPlayerVersion)}}))))},onPageViewEnd:function(){i(P(u,w({},{liveStreamData:n})))}},l);r={viewId:f.getValue(),type:"manual",subtype:"live-stream",clear:function(){c()}}};return{startManualTracking:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if("auto"===(null===(t=r)||void 0===t?void 0:t.type))throw"Cloudinary video analytics auto tracking is already connected with this HTML Video Element, to start manual tracking you need to stop auto tracking";F(function(e){return"object"!==z(e)?{isValid:!1,errorMessage:"Metadata param needs to be an object"}:"string"!=typeof e.cloudName?{isValid:!1,errorMessage:"You need to provide proper cloud name of your Cloudinary account [cloudName: string]"}:"string"==typeof e.type&&"live"!==e.type?{isValid:!1,errorMessage:'Property "type" can be either undefined or "live" value'}:"string"!=typeof e.publicId?"live"===e.type?{isValid:!1,errorMessage:"You need to provide proper public ID of your Live Stream output"}:{isValid:!1,errorMessage:"You need to provide proper video public ID of your video on your Cloudinary cloud [videoPublicId: string]"}:{isValid:!0}}(e),"Cloudinary video analytics manual tracking called without necessary data"),F(R(n),"Cloudinary video analytics manual tracking called with invalid options"),s(),"live"===e.type?m(e,n):(n.customVideoUrlFallback=n.customVideoUrlFallback||function(){return e},y(e,n))},stopManualTracking:s,startAutoTracking:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(r)throw"Cloudinary video analytics tracking is already connected with this HTML Video Element";F(R(e),"Cloudinary video analytics auto tracking called with invalid options");var t=c(),n=function(){if(t.getCollectedEventsCount()>0){t.addEvent(V());var e=I(H(t.flushEvents()));n={userId:o,viewId:f.getValue(),events:e},_(q.default,n)}var n},a=function(){var o=i.getCurrentSrc();if(o===window.location.href||!o)return null;f.regenerateValue(),t.start(f.getValue()),t.addEvent(E({videoUrl:o,trackingType:"auto"},e)),r={viewId:f,type:"auto",clear:function(){n(),t.destroy()}}};Y({onPageViewStart:function(){return a()},onPageViewEnd:function(){n(),t.destroy()}},l),i.onLoadStart((function(){return!r&&a()})),i.onEmptied((function(){return s()}))}}}})(),r})()));